name: Auto Movie Database Crawler

on:
  schedule:
    - cron: "0 */6 * * *"    # cháº¡y má»—i 6 tiáº¿ng
    - cron: "0 5 * * *"      # cháº¡y thÃªm 12h trÆ°a giá» VN (5h UTC)
  workflow_dispatch:          # cho phÃ©p cháº¡y thá»§ cÃ´ng

jobs:
  run-crawler:
    runs-on: ubuntu-latest

    steps:
      - name: ğŸ§© Checkout repository
        uses: actions/checkout@v4

      - name: ğŸ Set up Python
        uses: actions/setup-python@v5
        with:
          python-version: "3.10"

      - name: ğŸ“¦ Install dependencies
        run: |
          python -m pip install --upgrade pip
          pip install requests textblob pyodbc beautifulsoup4 lxml
          python -m textblob.download_corpora

      - name: âš™ï¸ Run crawler script
        env:
          TMDB_KEY: ${{ secrets.TMDB_KEY }}
          OMDB_KEY: ${{ secrets.OMDB_KEY }}
          DB_SERVER: ${{ secrets.DB_SERVER }}
          DB_NAME: ${{ secrets.DB_NAME }}
          DB_USER: ${{ secrets.DB_USER }}
          DB_PASS: ${{ secrets.DB_PASS }}
        run: |
          echo "ğŸ•’ UTC Time: $(date -u)"
          echo "ğŸ‡»ğŸ‡³ Vietnam Time: $(TZ='Asia/Ho_Chi_Minh' date)"
          python DATABASE.py